<%- include('../partials/head', { SITE }) %>
<%- include('../partials/nav', { SITE, path }) %>

<section class="section invite-section <%= (query && query.submitted) ? 'invite--confirmed' : '' %>" style="max-width:760px;">
  <h1>Request an Invitation</h1>

  <p class="lead">
    Atmakosh LLM is opening in a private, invite-only preview.
    Share how you intend to apply principled intelligence in your work.
  </p>

  <% if (query && query.submitted) { %>
    <div class="note note--success invite-confirm-card">
      <div class="invite-seal">
        <svg viewBox="0 0 24 24" width="28" height="28" aria-hidden="true">
          <path fill="currentColor" d="M9.0 16.2l-3.5-3.5 1.4-1.4 2.1 2.1 5.3-5.3 1.4 1.4z"/>
        </svg>
      </div>
      <h3>Thank you — your request has been received</h3>
      <p>We’ve added your name and email to the Atmakosh LLM invitation registry.</p>
      <div style="margin-top:22px;">
        <a href="/" class="btn btn--secondary">Back to Home</a>
      </div>
    </div>

  <% } else { %>
    <form method="POST" action="/api/invite" class="invite-form" id="invite-form">
      <label>
        <span>Name</span>
        <input type="text" name="name" required />
      </label>

      <label>
        <span>Email</span>
        <input type="email" name="email" required placeholder="you@company.com" />
      </label>

      <label>
        <span>LinkedIn Profile</span>
        <input 
          type="url" 
          name="linkedin" 
          placeholder="https://www.linkedin.com/in/..." 
          pattern=".*linkedin\.com.*" 
          title="Please enter a valid LinkedIn URL (e.g., https://linkedin.com/in/yourname)"
        />
        <small style="color:#888; font-size: 0.85em;">(Optional, helps expedite approval)</small>
      </label>

      <label>
        <span>How do you intend to apply Atmakosh’s wisdom?</span>
        <textarea name="intent" rows="5" required></textarea>
      </label>

      <button type="submit" class="btn btn--primary" id="invite-submit">
        Request Invitation
      </button>
    </form>
  <% } %>
  
  <% if (query && query.duplicate) { %>
    <div class="note note--warning" style="margin-top:20px; color:#f59e0b;">
      <strong>Notice:</strong> An invitation request for this email already exists.
    </div>
  <% } %>
  
  <% if (query && query.error === 'invalid_email') { %>
    <div class="note note--error" style="margin-top:20px; color:#ef4444; border-left: 3px solid #ef4444; padding-left:10px;">
      <strong>Error:</strong> Please enter a valid email address.
    </div>
  <% } %>

  <% if (query && query.error === 'invalid_linkedin') { %>
    <div class="note note--error" style="margin-top:20px; color:#ef4444; border-left: 3px solid #ef4444; padding-left:10px;">
      <strong>Error:</strong> Please enter a valid LinkedIn profile URL (must contain linkedin.com).
    </div>
  <% } %>
</section>

<script>
  (function () {
    const form = document.getElementById("invite-form");
    const btn = document.getElementById("invite-submit");
    if (!form || !btn) return;
    form.addEventListener("submit", function () {
      btn.disabled = true;
      btn.innerText = "Submitting…";
    });
  })();
</script>

<%- include('../partials/footer') %>
